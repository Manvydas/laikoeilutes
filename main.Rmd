---
title: "Laiko eilučių laboratorinių darbų užduotis"
subtitle: "Įskaitinių eismo įvykių Lietuvoje analizė"
author: "Linas Šyvis ir Manvydas Sokolovas"
output: html_document
---

```{r}
library(fpp)
library(tseries)
library(plyr)
```


* **1.Duomenų apžvalga**

```{r, echo = F}
data <- read.csv2("ivykiai.csv", header = T)
kiti <- read.csv2("menesiniai.csv", header = T, skip = 1)
emig <- read.csv2("emigrantai.csv", sep = ",")
colnames(data) <- c("Data", "Kaunas", "Klaipeda", "Panevezys", "Siauliai", "Vilnius")
ivykiai <- rowSums(data[,2:6])
tseries <- ts(ivykiai, start = c(2009, 1), frequency = 12)
plot(tseries, xlab = "Laikas", ylab = "Įvykių sk.", main = "Įskaitinių eismo įvykių Lietuvoje skaičius", col = "dark green", lwd = 3)
```

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Nagrinėti 2009-2017 metų mėnesiniai įskaitinių eismo įvykių Lietuvoje duomenys. 

* **2.Sezoniškumo įvertinimas**

Sezoniškumo ir kitų nuokrypių pagrindinės priežastys tikėtinai yra meteorologinės sąlygos, atostogų metas, alkoholio vartojimas, gyventojų skaičius.

* **3.1.Sezoniškumo įvertinimas**

Duomenyse pastebimas akivaizdus sezoniškumas, todėl jam įvertinti naudosime stl() funkciją, kuri iš laiko eilutės išskiria sezoninę ir trendo komponentes.

```{r, echo = F}
plot(stl(tseries, s.window="periodic"))
```

Grafikas patvirtina, kad duomenyse egzistuoja tam tikras sezoniškumas ir trendas.

* *3.2.Stacionarumo įvertinimas*

Augmented Dickey-Fuller ir Phillips-Perron H0 hipotezė tikrina ar duomenys turi vienetinę šaknį:
```{r}
adf.test(tseries)
pp.test(tseries)
```

Kwiatkowski-Phillips-Schmidt-Shin testo mažos p reikšmės rodo, kad duomenys nestacionarūs:
```{r}
kpss.test(tseries, null = c("Level", "Trend"))
```

Visi testai rodo, jog mūsų duomenys yra stacionarūs. Taigi duomenų transformacijos nėra reikalingos.


* **4.Tiesinis modelis**

```{r, echo = F}
kiti$ivykiai <- ivykiai[1:94]
list <- strsplit(as.character(kiti$laikas), "M")
df <- ldply(list)
duom <- cbind(df, kiti[,-1])
colnames(duom)[1:2] <- c("Metai", "Menuo")
duom$emigrantai <- emig[, 2]
duom$pavasaris <- ifelse(duom$Menuo %in% c("01", "02", "03", "04"), 1, 0)
```

```{r, echo = F}
tiesinis <- lm(ivykiu_skaicius ~ alkoholiniai_gerimai + transporto_priemoniu_isigijimas +  asmeniniu_transporto_priemoniu_eksploatacija + transporto_paslaugos + svietimas + transporto_priemoniu_draudimas + benzinas_95 + dyzelinas + pirma_karta_registruotos_priemones + keleiviu_vezimas_autobusais_tukstanciais + keleiviu_vezimas_viesuoju_tukstanciais + nedarbo_lygis_proc + gyventoju_sk + vid_temp + gryno_alko_1gyv + krituliai_mm + pavasaris, data = duom)
stepas <- step(tiesinis)

tiesinis1 <- lm(ivykiu_skaicius ~ alkoholiniai_gerimai + benzinas_95 + pavasaris, data = duom)
summary(tiesinis1)
```


